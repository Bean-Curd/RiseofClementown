<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Rise of Clemen-town Admin Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="shortcut icon"
      type="image/png"
      href="assets/images/icon/favicon.ico"
    />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
    <link rel="stylesheet" href="assets/css/themify-icons.css" />
    <link rel="stylesheet" href="assets/css/metisMenu.css" />
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="assets/css/slicknav.min.css" />
    <!-- amchart css -->
    <link
      rel="stylesheet"
      href="https://www.amcharts.com/lib/3/plugins/export/export.css"
      type="text/css"
      media="all"
    />
    <!-- others css -->
    <link rel="stylesheet" href="assets/css/typography.css" />
    <link rel="stylesheet" href="assets/css/default-css.css" />
    <link rel="stylesheet" href="assets/css/styles.css" />
    <link rel="stylesheet" href="assets/css/responsive.css" />
    <!-- modernizr css -->
    <script src="assets/js/vendor/modernizr-2.8.3.min.js"></script>
  </head>

  <body>
    <script
      type="module"
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"
    ></script>
    <script type="module">
      import { FIREBASE_CONFIG } from "./config.js";
      //for firebase app
      import {
        //determine which services you want to use
        initializeApp,
      } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
      //for realtime database
      import {
        //determine which services you want to use
        getDatabase,
        ref,
        set,
        get,
        onValue,
        push,
        child,
        update,
        remove,
      } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";
      //for auth
      import {
        //determine which services you want to use
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

      const app = initializeApp(FIREBASE_CONFIG);
      const db = getDatabase();
      const auth = getAuth();

      const UID = localStorage.getItem("admin");

      const players = ref(db, "players");
      const completionRate = ref(db, "statCompletedRate");
      const dailyActiveUsers = ref(db, "statDailyActive");
      const dailyNewUsers = ref(db, "statDailyNew");
      const totalSessionTime = ref(db, "statTotalTime");
      const medalGain = ref(db, "statMedalGain");
      const hiddenMedalGain = ref(db, "statHiddenMedalGain");

      const date = new Date();
      var year = date.getFullYear();
      var month = date.getMonth() + 1;
      var day = date.getDate();

      if (month.toString().length == 1) {
        month = "0" + month;
      }
      if (day.toString().length == 1) {
        day = "0" + day;
      }

      var finalDate = year + "" + month + "" + day;
      console.log(finalDate);

      //Found in getPlayers()
      let playerNum = 0; //Total number of players

      //Found in getDailyActiveUsers()
      let allDates = []; //Every date with activity: the dates in daily active users
      let activeYAxis = []; //Amount of active users per day
      let monthActiveYAxis = []; //Amount of active users per month

      //Found in getDailyNewUsers()
      let newYAxis = []; //Amount of new users per day
      let monthNewYAxis = []; //Amount of new users per month

      //Found in getTotalSessionTime()
      let dayTotalSession = []; //Total session time per day in seconds
      let timePlayed = 0; //Total time played by all players
      let todayTimePlayed = 0; //Time played by all players today

      //Found in getAmountCompleted()
      let amountCompleted = 0; //Amount of times players completed the game
      let todayAmountCompleted = 0; //Amount of times players completed the game today

      //Found in getMedalGain()
      let amtMedal = []; //Amount of medals gained per day
      let totalMedalGain = 0; //Amount of medals gained by all players

      //Found in getHiddenMedalGain()
      let amtHiddenMedal = []; //Amount of hidden medals gained per day
      let totalHiddenMedalGain = 0; //Amount of hidden medals gained by all players

      //Found in updateTotalNewActiveChart()
      let totalNewActiveData = []; //Data for the total session + new users + active users chart

      //Found in updateTotalTimeChart()
      let totalSessionData = []; //Data for the total session time chart

      getAccount();

      //When log out button is clicked
      let btnLogOut = document.getElementById("logout");
      btnLogOut.addEventListener("click", function (e) {
        e.preventDefault();

        console.log("signing out");
        signOut(auth);
        //Remove the admin from the local storage
        localStorage.removeItem("admin");
        window.location.href = "index.html";
      });

      //Get the admin's acccount from the database
      async function getAccount() {
        await get(ref(db, "admins/" + UID)).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              snapshot.forEach((childSnapshot) => {
                if (childSnapshot.key == "username") {
                  $("#username").text(childSnapshot.val());
                }
              });
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getAccount() snapshot does not exist");
          }
        });
      }

      /*-------------- Get functions for data start ------------*/

      //Call functions to get data
      (async () => {
        await check();

        await getPlayers();
        await getDailyActiveUsers();
        await getDailyNewUsers();
        await getTotalSessionTime();
        await getAmountCompleted();
        await getMedalGain();
        await getHiddenMedalGain();
      })();

      //Check if things are in the firebase yet
      function check() {
        console.log("checking");
        get(ref(db, "statCompletedRate/" + finalDate)).then((snapshot) => {
          if (snapshot.exists()) {
          } else {
            set(ref(db, "statCompletedRate/" + finalDate), 0);
          }
        });
        get(ref(db, "statDailyActive/" + finalDate)).then((snapshot) => {
          if (snapshot.exists()) {
          } else {
            set(ref(db, "statDailyActive/" + finalDate), 0);
          }
        });
        get(ref(db, "statDailyNew/" + finalDate)).then((snapshot) => {
          if (snapshot.exists()) {
          } else {
            set(ref(db, "statDailyNew/" + finalDate), 0);
            console.log("set new");
          }
        });
        get(ref(db, "statHiddenMedalGain/" + finalDate)).then((snapshot) => {
          if (snapshot.exists()) {
          } else {
            set(ref(db, "statHiddenMedalGain/" + finalDate), 0);
          }
        });
        get(ref(db, "statMedalGain/" + finalDate)).then((snapshot) => {
          if (snapshot.exists()) {
          } else {
            set(ref(db, "statMedalGain/" + finalDate), 0);
          }
        });
        get(ref(db, "statTotalTime/" + finalDate)).then((snapshot) => {
          if (snapshot.exists()) {
          } else {
            set(ref(db, "statTotalTime/" + finalDate), 0);
          }
        });
        console.log("done checking");
      }

      //Get the number of players
      async function getPlayers() {
        console.log("getting number of players");
        await get(players).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let logs = snapshot.size;
              //update our chart UI
              playerNum = logs;
              return playerNum;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getPlayers() snapshot does not exist");
          }
        });
      }

      //Get the number of daily active users
      async function getDailyActiveUsers() {
        console.log("getting daily active users");
        await get(dailyActiveUsers).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let dates = [];
              let logs = [];
              let months = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
              let total = [];

              snapshot.forEach((childSnapshot) => {
                //push data to our arrays for our X/Y axes later
                dates.push(childSnapshot.key);
                logs.push(childSnapshot.size);

                let month = parseInt(childSnapshot.key.substr(4, 2), 10) - 1; //get month of snapshot in int
                let amount = months[month];
                months[month] = amount + childSnapshot.size;

                if (childSnapshot.key == finalDate) {
                  //If today is in the database, update the today's active users
                  $("#todayActiveUsers").text(childSnapshot.size); //The data in the 1st row of stats
                }
              });
              //update our chart UI
              allDates = dates;
              activeYAxis = logs;
              monthActiveYAxis = months;
              return allDates, activeYAxis, monthActiveYAxis;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getDailyActiveUsers() snapshot does not exist");
          }
        });
      }

      //Get the number of daily new users
      async function getDailyNewUsers() {
        console.log("getting daily new users");
        await get(dailyNewUsers).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let logs = [];
              let months = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
              let total = [];

              snapshot.forEach((childSnapshot) => {
                //push data to our arrays for our X/Y axes later
                logs.push(childSnapshot.val());

                let month = parseInt(childSnapshot.key.substr(4, 2), 10) - 1; //get month of snapshot in int
                let amount = months[month];
                months[month] = amount + childSnapshot.val();
                if (childSnapshot.key == finalDate) {
                  //If today is in the database, update the today's new users
                  $("#todayNewUsers").text(childSnapshot.val()); //The data in the 1st row of stats
                }
              });
              //update our chart UI
              newYAxis = logs;
              monthNewYAxis = months;
              updateNewActiveChart(newYAxis, activeYAxis);
              updateMonthChart(monthActiveYAxis, monthNewYAxis);
              return newYAxis, monthNewYAxis;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getDailyNewUsers() snapshot does not exist");
          }
        });
      }

      //Get the total session time in seconds
      async function getTotalSessionTime() {
        console.log("getting total session time");
        await get(totalSessionTime).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let time = []; //time in seconds
              let total = 0;

              snapshot.forEach((childSnapshot) => {
                //for each day in total session time
                time.push(childSnapshot.val());
                total += childSnapshot.val();
                if (childSnapshot.key == finalDate) {
                  //If today is in the database, update the today's active users
                  todayTimePlayed = childSnapshot.val();
                }
              });
              //update our chart UI
              dayTotalSession = time;
              timePlayed = total;
              updateTotalTimeChart(allDates, dayTotalSession);
              updateTotalNewActiveChart(
                allDates,
                activeYAxis,
                newYAxis,
                dayTotalSession
              );
              return dayTotalSession, timePlayed;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getTotalSessionTime() snapshot does not exist");
          }
        });
      }

      //Get the number of player who have completed the game
      async function getAmountCompleted() {
        console.log("getting completion rate");
        await get(completionRate).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let logs = 0;

              snapshot.forEach((childSnapshot) => {
                //push data to our arrays for our X/Y axes later
                logs += childSnapshot.val();
                if (childSnapshot.key == finalDate) {
                  //If today is in the database, update the today's active users
                  todayAmountCompleted = childSnapshot.val();
                }
              });
              //update our chart UI
              amountCompleted = logs;
              updateTodayStats(todayAmountCompleted, todayTimePlayed);
              return amountCompleted;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getAmountCompleted() snapshot does not exist");
          }
        });
      }

      //Get the number of medals gained
      async function getMedalGain() {
        console.log("getting medal gain rate");
        await get(medalGain).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let logs = 0;
              let medals = [];

              snapshot.forEach((childSnapshot) => {
                //push data to our arrays for our X/Y axes later
                medals.push(childSnapshot.val());
                logs += childSnapshot.val();
                if (childSnapshot.key == finalDate) {
                  //If today is in the database, update the today's medal gain
                  $("#today_num_medal").text("+ " + childSnapshot.val()); //The today's stats in the 3rd row of stats
                }
              });
              //update our chart UI
              amtMedal = medals;
              totalMedalGain = logs;
              return amtMedal, totalMedalGain;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getMedalGain() snapshot does not exist");
          }
        });
      }

      //Get the number of hidden medals gained
      async function getHiddenMedalGain() {
        console.log("getting hidden medal gain rate");
        await get(hiddenMedalGain).then((snapshot) => {
          if (snapshot.exists()) {
            try {
              let content = "";
              //setup our temp arrays
              let logs = 0;
              let medals = [];

              snapshot.forEach((childSnapshot) => {
                //push data to our arrays for our X/Y axes later
                medals.push(childSnapshot.val());
                logs += childSnapshot.val();
                if (childSnapshot.key == finalDate) {
                  //If today is in the database, update the today's medal gain
                  $("#today_hidden_medal").text("+ " + childSnapshot.val()); //The today's stats in the 3rd row of stats
                }
              });
              //update our chart UI
              amtHiddenMedal = medals;
              totalHiddenMedalGain = logs;
              updateStats(
                amountCompleted,
                timePlayed,
                playerNum,
                totalMedalGain,
                totalHiddenMedalGain
              );
              updateMedalChart(amtMedal, amtHiddenMedal);
              return amtHiddenMedal, totalHiddenMedalGain;
            } catch (error) {
              console.log(error);
            }
          } else {
            console.log("getHiddenMedalGain() snapshot does not exist");
          }
        });
      }

      /*-------------- Get functions for data end ------------*/
      /*-------------- Creating charts and numbers start ------------*/

      //Updates the 2nd + 3rd row of stats (called in getHiddenMedalGain())
      function updateStats(
        amountCompleted,
        timePlayed,
        playerNum,
        totalMedalGain,
        totalHiddenMedalGain
      ) {
        console.log("updating stats");
        $("#num_of_players").text(playerNum + " players");
        $("#num_time_played").text(Math.round(timePlayed / 60) + " minutes");
        $("#num_amount_complete").text(amountCompleted + " times");
        $("#num_medal").text(totalMedalGain + " medals");
        $("#num_hidden_medal").text(totalHiddenMedalGain + " hidden medals");
      }

      //Updates today's stats in the 2nd + 3rd row of stats (called in getAmountCompleted())
      function updateTodayStats(todayAmountCompleted, todayTimePlayed) {
        console.log("updating sub stats");
        $("#today_num_amount_complete").text("+ " + todayAmountCompleted);
        $("#today_num_time_played").text(
          "+ " + Math.round(todayTimePlayed / 60)
        );
      }

      //Updates the daily new active chart (called in getDailyNewUsers())
      function updateNewActiveChart(newYAxis, activeYAxis) {
        console.log("updating daily new + active chart");
        if ($("#new_active_graph_day").length) {
          Highcharts.chart("new_active_graph_day", {
            chart: {
              type: "areaspline",
            },
            title: false,
            yAxis: {
              title: false,
              gridLineColor: "#Ececec",
              gridLineWidth: 1,
            },
            xAxis: {
              categories: allDates,
              gridLineColor: "#Ececec",
              gridLineWidth: 1,
            },
            series: [
              {
                name: "Active Users",
                data: activeYAxis,
                color: "#12C599",
                fillColor: "rgba(17, 196, 151, 0.6)",
                lineColor: "transparent",
              },
              {
                name: "New Users",
                data: newYAxis,
                color: "#5F73F2",
                fillColor: "rgba(83, 90, 249, 0.6)",
                lineColor: "transparent",
              },
            ],
          });
        }
      }

      //Updates the monthly new active chart (called in getDailyNewUsers())
      function updateMonthChart(monthActiveYAxis, monthNewYAxis) {
        console.log("updating monthly new + active chart");
        if ($("#new_active_graph_month").length) {
          Highcharts.chart("new_active_graph_month", {
            chart: {
              type: "column",
            },
            title: false,
            xAxis: {
              categories: [
                "Jan",
                "Feb",
                "Mar",
                "Apr",
                "May",
                "Jun",
                "Jul",
                "Aug",
                "Sep",
                "Oct",
                "Nov",
                "Dec",
              ],
            },
            colors: ["#12C599", "#5F73F2"],
            yAxis: {
              min: 0,
              title: false,
            },
            tooltip: {
              pointFormat:
                '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',
              shared: true,
            },
            plotOptions: {
              column: {
                stacking: "column",
              },
            },
            series: [
              {
                name: "Active Users",
                data: monthActiveYAxis,
              },
              {
                name: "New Users",
                data: monthNewYAxis,
              },
            ],
          });
        }
      }

      // Updates the total new active chart by day (total time + active users + new users)(called in getTotalSessionTime())
      function updateTotalNewActiveChart(
        allDates,
        activeYAxis,
        newYAxis,
        dayTotalSession
      ) {
        console.log("formatting");
        for (let i = 0; i < allDates.length; i++) {
          let selectedDate = allDates[i];
          let obj = {};

          obj.date =
            selectedDate.substr(0, 4) +
            "-" +
            selectedDate.substr(4, 2) +
            "-" +
            selectedDate.substr(6, 2);

          obj.activeplayers = activeYAxis[i];
          obj.newplayers = newYAxis[i];
          obj.sessiontime = dayTotalSession[i];

          totalNewActiveData.push(obj);

          if (i == allDates.length - 1) {
            console.log(
              "updating total session + new users + active users chart"
            );
            console.log(totalNewActiveData);
            if ($("#total_new_active").length) {
              var chart = AmCharts.makeChart("total_new_active", {
                type: "serial",
                theme: "light",
                dataDateFormat: "YYYY-MM-DD",
                valueAxes: [
                  {
                    id: "v1",
                    title: "Duration (Minutes)", //in minutes: would be hours if we had more data samples
                    position: "left",
                    autoGridCount: false,
                    labelFunction: function (value) {
                      return Math.round(value / 60);
                    },
                  },
                  {
                    id: "v2",
                    title: "Number of people",
                    gridAlpha: 0,
                    position: "right",
                    autoGridCount: false,
                  },
                ],
                graphs: [
                  {
                    id: "g3",
                    valueAxis: "v1",
                    lineColor: "#a77de3",
                    fillColors: "#a77de3",
                    fillAlphas: 1,
                    type: "column",
                    title: "Total Session Time",
                    valueField: "sessiontime",
                    clustered: false,
                    columnWidth: 0.3,
                    balloonText:
                      "[[title]]<br /><small style='font-size: 130%'>[[value]]</small>",
                  },
                  {
                    id: "g1",
                    valueAxis: "v2",
                    bullet: "round",
                    bulletBorderAlpha: 1,
                    bulletColor: "#FFFFFF",
                    bulletSize: 5,
                    hideBulletsCount: 50,
                    lineThickness: 2,
                    lineColor: "#3f52cc",
                    type: "smoothedLine",
                    title: "New Players",
                    dashLength: 5,
                    useLineColorForBulletBorder: true,
                    valueField: "newplayers",
                    balloonText:
                      "[[title]]<br /><small style='font-size: 130%'>[[value]]</small>",
                  },
                  {
                    id: "g2",
                    valueAxis: "v2",
                    bullet: "round",
                    bulletBorderAlpha: 1,
                    bulletColor: "#FFFFFF",
                    bulletSize: 5,
                    hideBulletsCount: 50,
                    lineThickness: 2,
                    lineColor: "#12C599",
                    type: "smoothedLine",
                    title: "Active Players",
                    useLineColorForBulletBorder: true,
                    valueField: "activeplayers",
                    balloonText:
                      "[[title]]<br /><small style='font-size: 130%'>[[value]]</small>",
                  },
                ],
                chartScrollbar: {
                  graph: "g1",
                  oppositeAxis: false,
                  offset: 50,
                  scrollbarHeight: 45,
                  backgroundAlpha: 0,
                  selectedBackgroundAlpha: 0.5,
                  selectedBackgroundColor: "#f9f9f9",
                  graphFillAlpha: 0.1,
                  graphLineAlpha: 0.4,
                  selectedGraphFillAlpha: 0,
                  selectedGraphLineAlpha: 1,
                  autoGridCount: true,
                  color: "#95a1f9",
                },
                chartCursor: {
                  pan: true,
                  valueLineEnabled: true,
                  valueLineBalloonEnabled: true,
                  cursorAlpha: 0,
                  valueLineAlpha: 0.2,
                },
                categoryField: "date",
                categoryAxis: {
                  parseDates: true,
                  dashLength: 1,
                  minorGridEnabled: true,
                  color: "#5C6DF4",
                },
                legend: {
                  useGraphSettings: true,
                  position: "top",
                },
                balloon: {
                  borderThickness: 1,
                  shadowAlpha: 0,
                },
                export: {
                  enabled: false,
                },
                dataProvider: totalNewActiveData,
              });
            }
          }
        }
      }

      // Updates the total time chart by day (called in getTotalSessionTime())
      function updateTotalTimeChart(allDates, dayTotalSession) {
        console.log("formatting");
        for (let i = 0; i < allDates.length; i++) {
          let selectedDate = allDates[i];
          let obj = {};

          obj.date =
            selectedDate.substr(0, 4) +
            "-" +
            selectedDate.substr(4, 2) +
            "-" +
            selectedDate.substr(6, 2);
          obj.value = dayTotalSession[i];

          totalSessionData.push(obj);
          if (i == allDates.length - 1) {
            console.log("updating total session time chart");
            if ($("#total_session_time").length) {
              var chart = AmCharts.makeChart("total_session_time", {
                type: "serial",
                theme: "light",
                marginRight: 0,
                marginLeft: 40,
                autoMarginOffset: 20,
                dataDateFormat: "YYYY-MM-DD",
                valueAxes: [
                  {
                    id: "v1",
                    axisAlpha: 0,
                    position: "left",
                    ignoreAxisWidth: true,
                  },
                ],
                balloon: {
                  borderThickness: 1,
                  shadowAlpha: 0,
                },
                graphs: [
                  {
                    id: "g1",
                    balloon: {
                      drop: true,
                      adjustBorderColor: false,
                      color: "#ffffff",
                      type: "smoothedLine",
                    },
                    fillAlphas: 0.2,
                    bullet: "round",
                    bulletBorderAlpha: 1,
                    bulletColor: "#FFFFFF",
                    bulletSize: 5,
                    hideBulletsCount: 50,
                    lineColor: "#a77de3",
                    fillColors: "#a77de3",
                    lineThickness: 2,
                    title: "red line",
                    useLineColorForBulletBorder: true,
                    valueField: "value",
                    balloonText:
                      "<span style='font-size:18px;'>[[value]]</span>",
                  },
                ],
                chartCursor: {
                  valueLineEnabled: true,
                  valueLineBalloonEnabled: true,
                  cursorAlpha: 0,
                  zoomable: false,
                  valueZoomable: true,
                  valueLineAlpha: 0.5,
                },
                valueScrollbar: {
                  autoGridCount: true,
                  color: "#5E72F3",
                  scrollbarHeight: 30,
                },
                categoryField: "date",
                categoryAxis: {
                  parseDates: true,
                  dashLength: 1,
                  minorGridEnabled: true,
                },
                export: {
                  enabled: false,
                },
                dataProvider: totalSessionData,
              });
            }
          }
        }
      }

      //Updates the medal and hidden medal gain chart (called in getHiddenMedalGain())
      function updateMedalChart(amtMedal, amtHiddenMedal) {
        console.log("updating medal + hidden medal chart");
        if ($("#medal_hidden_graph_day").length) {
          Highcharts.chart("medal_hidden_graph_day", {
            chart: {
              type: "areaspline",
            },
            title: false,
            yAxis: {
              title: false,
              gridLineColor: "#Ececec",
              gridLineWidth: 1,
            },
            xAxis: {
              categories: allDates,
              gridLineColor: "#Ececec",
              gridLineWidth: 1,
            },
            series: [
              {
                name: "Medals Gained",
                data: amtMedal,
                color: "#f2be46",
                fillColor: "rgba(242, 190, 70, 0.6)",
                lineColor: "transparent",
              },
              {
                name: "Hidden Medals Gained",
                data: amtHiddenMedal,
                color: "#e36e6b",
                fillColor: "rgba(227, 110, 107, 0.6)",
                lineColor: "transparent",
              },
            ],
          });
        }
      }
      /*-------------- Creating charts and numbers end ------------*/
    </script>
    <!-- preloader area start -->
    <div id="preloader">
      <div class="loader"></div>
    </div>
    <!-- preloader area end -->
    <!-- page container area start -->
    <div class="page-container">
      <!-- sidebar menu area start -->
      <div class="sidebar-menu">
        <div class="sidebar-header">
          <div class="logo">
            <a href="adminStatistics.html"
              ><img src="assets/images/icon/logo.png" alt="logo"
            /></a>
          </div>
        </div>
        <div class="main-menu">
          <div class="menu-inner">
            <nav>
              <ul class="metismenu" id="menu">
                <li class="active">
                  <a href="javascript:void(0)" aria-expanded="true"
                    ><i class="ti-bar-chart"></i><span>Dashboard</span></a
                  >
                  <ul class="collapse">
                    <li class="active">
                      <a href="adminStatistics.html">Statistics</a>
                    </li>
                  </ul>
                </li>
                <li>
                  <a href="javascript:void(0)" aria-expanded="true"
                    ><i class="ti-user"></i><span>Players</span></a
                  >
                  <ul class="collapse">
                    <li><a href="adminImages.html">Images</a></li>
                    <li>
                      <a href="adminPlayers.html">Player Accounts</a>
                    </li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
      <!-- sidebar menu area end -->
      <!-- main content area start -->
      <div class="main-content">
        <!-- header area start -->
        <div class="header-area">
          <div class="row align-items-center">
            <!-- nav and search button -->
            <div class="col-md-6 col-sm-8 clearfix">
              <div class="nav-btn pull-left">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
            <!-- profile info & task notification -->
            <div class="col-md-6 col-sm-4 clearfix">
              <ul class="notification-area pull-right">
                <li id="full-view"><i class="ti-fullscreen"></i></li>
                <li id="full-view-exit"><i class="ti-zoom-out"></i></li>
                <li class="dropdown">
                  <i class="ti-bell dropdown-toggle" data-toggle="dropdown">
                    <!-- <span>2</span> -->
                  </i>
                  <div class="dropdown-menu bell-notify-box notify-box">
                    <span class="notify-title"
                      >You have 0 new notifications
                    </span>
                    <div class="nofity-list">
                      <a href="#" class="notify-item">
                        <div class="notify-thumb">
                          <i class="ti-comments-smiley btn-info"></i>
                        </div>
                        <div class="notify-text">
                          <p>You made an Announcement</p>
                          <span>09:00</span>
                        </div>
                      </a>
                      <a href="#" class="notify-item">
                        <div class="notify-thumb">
                          <i class="ti-key btn-danger"></i>
                        </div>
                        <div class="notify-text">
                          <p>You Changed your Password</p>
                          <span>30 Days ago</span>
                        </div>
                      </a>
                    </div>
                  </div>
                </li>
                <script type="module">
                  $("#notif-num").text("2");
                  $("#notif-text").text("You have 2 new notifications");

                  document.getElementById("message-notifs").onclick =
                    function () {
                      $("#notif-num").remove();
                      $(".dropdown-menu notify-box nt-enveloper-box").class =
                        "show";
                    };
                </script>
                <li class="dropdown" id="message-notifs">
                  <i
                    class="fa fa-envelope-o dropdown-toggle"
                    data-toggle="dropdown"
                    ><span id="notif-num"></span
                  ></i>
                  <div class="dropdown-menu notify-box nt-enveloper-box">
                    <span class="notify-title" id="notif-text"> </span>
                    <div class="nofity-list">
                      <a href="#" class="notify-item">
                        <div class="notify-thumb">
                          <img
                            src="assets/images/author/author-img1.png"
                            alt="image"
                          />
                        </div>
                        <div class="notify-text">
                          <p>[Admin] Spaghetti</p>
                          <span class="msg"
                            >Hello, I am waiting for you...</span
                          >
                          <span>Yesterday</span>
                        </div>
                      </a>
                      <a href="#" class="notify-item">
                        <div class="notify-thumb">
                          <img
                            src="assets/images/author/author-img1.png"
                            alt="image"
                          />
                        </div>
                        <div class="notify-text">
                          <p>[Admin] Meatballs</p>
                          <span class="msg">When you are free...</span>
                          <span>30/12/23</span>
                        </div>
                      </a>
                    </div>
                  </div>
                </li>
                <li class="settings-btn">
                  <i class="ti-settings"></i>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <!-- header area end -->
        <!-- offset area start -->
        <div class="offset-area">
          <div class="offset-close"><i class="ti-close"></i></div>
          <ul class="nav offset-menu-tab">
            <li>
              <a class="active" data-toggle="tab" href="#activity">Activity</a>
            </li>
            <li><a data-toggle="tab" href="#settings">Settings</a></li>
          </ul>
          <div class="offset-content tab-content">
            <div id="activity" class="tab-pane fade in show active">
              <div class="recent-activity">
                <div class="timeline-task">
                  <div class="icon bg2">
                    <i class="fa fa-check"></i>
                  </div>
                  <div class="tm-title">
                    <h4>Solved</h4>
                    <span class="time"
                      ><i class="ti-time"></i>11 Minutes Ago</span
                    >
                  </div>
                  <p>
                    [Admin] Mushroom completed [User] Potato , [UID]
                    A8vM47IfRnfzjXhho97rW0kZhUr2 's request.
                  </p>
                </div>
                <div class="timeline-task">
                  <div class="icon bg3">
                    <i class="ti-pin2"></i>
                  </div>
                  <div class="tm-title">
                    <h4>Task Opened</h4>
                    <span class="time"
                      ><i class="ti-time"></i>36 Minutes Ago</span
                    >
                  </div>
                  <p>
                    Task has been opened for [User] Potato , [UID]
                    A8vM47IfRnfzjXhho97rW0kZhUr2 by [Admin] Mushroom.
                  </p>
                </div>
                <div class="timeline-task">
                  <div class="icon bg1">
                    <i class="fa fa-envelope"></i>
                  </div>
                  <div class="tm-title">
                    <h4>Potato sent an email</h4>
                    <span class="time"
                      ><i class="ti-time"></i>38 Minutes Ago</span
                    >
                  </div>
                  <p>Dear admin, I have problems logging into my account...</p>
                </div>
                <div class="timeline-task">
                  <div class="icon bg2">
                    <i class="ti-server"></i>
                  </div>
                  <div class="tm-title">
                    <h4>Server Open</h4>
                    <span class="time"><i class="ti-time"></i>10:35</span>
                  </div>
                  <p>Maintenance has ended and the server has been opened.</p>
                </div>
                <div class="timeline-task">
                  <div class="icon bg3">
                    <i class="ti-announcement"></i>
                  </div>
                  <div class="tm-title">
                    <h4>Maintenance Extended</h4>
                    <span class="time"><i class="ti-time"></i>10:00</span>
                  </div>
                  <p>The server maintenance will be extended by 30 Minutes.</p>
                </div>
                <div class="timeline-task">
                  <div class="icon bg3">
                    <i class="ti-server"></i>
                  </div>
                  <div class="tm-title">
                    <h4>Server Closed</h4>
                    <span class="time"><i class="ti-time"></i>09:15</span>
                  </div>
                  <p>The server has been closed for maintenance.</p>
                </div>
              </div>
            </div>
            <div id="settings" class="tab-pane fade">
              <div class="offset-settings">
                <h4>General Settings</h4>
                <div class="settings-list">
                  <div class="s-settings">
                    <div class="s-sw-title">
                      <h5>Notifications</h5>
                      <div class="s-swtich">
                        <input type="checkbox" id="switch1" />
                        <label for="switch1">Toggle</label>
                      </div>
                    </div>
                    <p>Toggle 'On' to get all notifications.</p>
                  </div>
                  <div class="s-settings">
                    <div class="s-sw-title">
                      <h5>Clear old activity</h5>
                      <div class="s-swtich">
                        <input type="checkbox" id="switch2" checked />
                        <label for="switch2">Toggle</label>
                      </div>
                    </div>
                    <p>
                      Toggle 'On' to delete activity after the last 24 hours.
                    </p>
                  </div>
                  <div class="s-settings">
                    <div class="s-sw-title">
                      <h5>Link email</h5>
                      <div class="s-swtich">
                        <input type="checkbox" id="switch3" checked />
                        <label for="switch3">Toggle</label>
                      </div>
                    </div>
                    <p>Toggle 'On' to show email notifications.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- offset area end -->
        <!-- page title area start -->
        <div class="page-title-area">
          <div class="row align-items-center">
            <div class="col-sm-6">
              <div class="breadcrumbs-area clearfix">
                <h4 class="page-title pull-left">Rise of Clemen-town</h4>
                <ul class="breadcrumbs pull-left">
                  <li><a>Dashboard</a></li>
                  <li><span>Statistics</span></li>
                </ul>
              </div>
            </div>
            <div class="col-sm-6 clearfix">
              <div class="user-profile pull-right">
                <img
                  class="avatar user-thumb"
                  src="assets/images/author/avatar.png"
                  alt="avatar"
                />
                <h4
                  class="user-name dropdown-toggle"
                  data-toggle="dropdown"
                  id="username"
                >
                  - <i class="fa fa-angle-down"></i>
                </h4>
                <div class="dropdown-menu">
                  <!-- <a class="dropdown-item" href="#">Profile</a> -->
                  <a class="dropdown-item" id="logout" href="index.html"
                    >Log Out</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- page title area end -->
        <div class="main-content-inner">
          <!-- daily new + active users start -->
          <div class="row">
            <div class="col-md-6 mt-5 mb-3">
              <div class="card">
                <div class="seo-fact sbg1">
                  <div
                    class="p-4 d-flex justify-content-between align-items-center"
                  >
                    <div class="seofct-icon">
                      <i class="ti-pencil-alt"></i> Today's New Users
                    </div>
                    <h2 id="todayNewUsers">0</h2>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6 mt-md-5 mb-3">
              <div class="card">
                <div class="seo-fact sbg2">
                  <div
                    class="p-4 d-flex justify-content-between align-items-center"
                  >
                    <div class="seofct-icon">
                      <i class="ti-eye"></i> Today's Active Users
                    </div>
                    <h2 id="todayActiveUsers">0</h2>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- daily new + active users end -->
          <!-- additional stats start -->
          <div class="sales-report-area mt-5 mb-5">
            <div class="row">
              <div class="col-md-4">
                <div class="single-report mb-xs-30">
                  <div class="s-report-inner pr--20 pt--30 mb-3">
                    <div class="icon"><i class="ti-user"></i></div>
                    <div class="s-report-title d-flex justify-content-between">
                      <h4 class="header-title mb-0">Total Number of Players</h4>
                    </div>
                    <div class="d-flex justify-content-between pb-2">
                      <h2 id="num_of_players">0</h2>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="single-report mb-xs-30">
                  <div class="s-report-inner pr--20 pt--30 mb-3">
                    <div class="icon"><i class="ti-time"></i></div>
                    <div class="s-report-title d-flex justify-content-between">
                      <h4 class="header-title mb-0">Total Time Played</h4>
                    </div>
                    <div class="d-flex justify-content-between pb-2">
                      <h2 id="num_time_played">0</h2>
                      <span id="today_num_time_played">+ 0</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="single-report mb-xs-30">
                  <div class="s-report-inner pr--20 pt--30 mb-3">
                    <div class="icon"><i class="ti-cup"></i></div>
                    <div class="s-report-title d-flex justify-content-between">
                      <h4 class="header-title mb-0">
                        Amount of Times Completed
                      </h4>
                    </div>
                    <div class="d-flex justify-content-between pb-2">
                      <h2 id="num_amount_complete">0</h2>
                      <span id="today_num_amount_complete">+ 0</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="sales-report-area mt-5 mb-5">
            <div class="row">
              <div class="col-md-6">
                <div class="single-report mb-xs-30">
                  <div class="s-report-inner pr--20 pt--30 mb-3">
                    <div class="icon"><i class="ti-medall-alt"></i></div>
                    <div class="s-report-title d-flex justify-content-between">
                      <h4 class="header-title mb-0">Total Medal Gain</h4>
                    </div>
                    <div class="d-flex justify-content-between pb-2">
                      <h2 id="num_medal">0</h2>
                      <span id="today_num_medal">+ 0</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="single-report mb-xs-30">
                  <div class="s-report-inner pr--20 pt--30 mb-3">
                    <div class="icon"><i class="ti-medall"></i></div>
                    <div class="s-report-title d-flex justify-content-between">
                      <h4 class="header-title mb-0">Total Hidden Medal Gain</h4>
                    </div>
                    <div class="d-flex justify-content-between pb-2">
                      <h2 id="num_hidden_medal">0</h2>
                      <span id="today_hidden_medal">+ 0</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- additional stats end -->
          <!-- total new + active users by day start -->
          <div class="card mt-5">
            <div class="card-body">
              <div class="d-flex justify-content-between mb-5">
                <h4 class="header-title mb-0">Daily New and Active Users</h4>
              </div>
              <div id="new_active_graph_day"></div>
            </div>
          </div>
          <!-- total new + active users by day end -->
          <!-- total new + active users by month start -->
          <div class="mt-5">
            <div class="card">
              <div class="card-body pb-0">
                <h4 class="header-title">Monthly New and Active Users</h4>
                <div id="new_active_graph_month"></div>
              </div>
            </div>
          </div>
          <!-- total new + active users by month end -->
          <!-- total session + new users + active users start -->
          <div class="col-xl-12 col-ml-12 col-lg-12 mt-5">
            <div class="card">
              <div class="card-body">
                <h4 class="header-title">Players against Session Time</h4>
                <div id="total_new_active" style="height: 500px"></div>
              </div>
            </div>
          </div>
          <!-- total session + new users + active users end -->
          <!-- total session time start -->
          <div class="col-lg-12 mt-5">
            <div class="card">
              <div class="card-body">
                <h4 class="header-title">Total Session Time</h4>
                <div id="total_session_time" style="height: 400px"></div>
              </div>
            </div>
          </div>
          <!-- total session time end -->
          <!-- total medal + hidden medal gain by day start -->
          <div class="card mt-5">
            <div class="card-body">
              <div class="d-flex justify-content-between mb-5">
                <h4 class="header-title mb-0">
                  Daily Medal and Hidden Medal Gain
                </h4>
              </div>
              <div id="medal_hidden_graph_day"></div>
            </div>
          </div>
          <!-- total medal + hidden medal gain by day end -->
          <!-- row area start-->
        </div>
      </div>
      <!-- main content area end -->
      <!-- footer area start-->
      <footer>
        <div class="footer-area">
          <p>
            © Copyright 2018. All right reserved. Template by
            <a href="https://colorlib.com/wp/">Colorlib</a>.
          </p>
        </div>
      </footer>
      <!-- footer area end-->
    </div>
    <!-- page container area end -->
    <!-- jquery latest version -->
    <script src="assets/js/vendor/jquery-2.2.4.min.js"></script>
    <!-- bootstrap 4 js -->
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/metisMenu.min.js"></script>
    <script src="assets/js/jquery.slimscroll.min.js"></script>
    <script src="assets/js/jquery.slicknav.min.js"></script>

    <!-- start chart js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
    <!-- start highcharts js -->
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <!-- start zingchart js -->
    <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
    <script>
      zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
      ZC.LICENSE = [
        "569d52cefae586f634c54f86dc99e6a9",
        "ee6b7db5b51705a13dc2339db3edaf6d",
      ];
    </script>
    <!-- start amcharts -->
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="https://www.amcharts.com/lib/3/ammap.js"></script>
    <script src="https://www.amcharts.com/lib/3/maps/js/worldLow.js"></script>
    <script src="https://www.amcharts.com/lib/3/serial.js"></script>
    <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
    <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
    <!-- others plugins -->
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/scripts.js"></script>
  </body>
</html>
